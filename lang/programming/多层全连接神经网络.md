

# 多层全连接神经网络



上标表示层，输入是第$0$ 层，输出是第$K$ 层

第$1$ 到$K-1$ 层是隐层

$x^0_i$ 第$0$ 层输入向量的第$i$ 分量

$n_0$ 第$0$ 层总共有$n_0$ 个分量

$a^k_i$ 第$k$ 层第$i$ 个神经元的仿射值

$x^k_i$ 第$k$ 层第$i$ 个神经元的激活值

第$k$ 层有$n_k$ 个神经元，所以该层有$n_k$ 个输出





## 前向传播



$f$ 激活，$g$ 仿射映射

> 仿射映射可以看作由若干个仿射函数组成
>
> 仿射函数是一个线性函数加上一个常量




$$
g(W,X,B) = W \cdot X + B =

\begin{bmatrix}
w^{1}_{1} & w^{1}_{2} & \cdots & w^{1}_{n}  \\
w^{2}_{1} & w^{2}_{2} & \cdots & w^{2}_{n} \\
\vdots & \vdots & \ddots & \vdots & \\
w^{n}_{1} & w^{n}_{2} & \cdots & w^{n}_{n} \\
\end{bmatrix}

\cdot 

\begin{bmatrix}
x^{1}_{1} & x^{1}_{2} & \cdots & x^{1}_{m}  \\
x^{2}_{1} & x^{2}_{2} & \cdots & x^{2}_{m} \\
\vdots & \vdots & \ddots & \vdots & \\
x^{n}_{1} & x^{n}_{2} & \cdots & x^{n}_{m} \\
\end{bmatrix}

+ 

\begin{bmatrix}
b^{1}_{1} & b^{1}_{2} & \cdots & b^{1}_{n}  \\
b^{2}_{1} & b^{2}_{2} & \cdots & b^{2}_{n} \\
\vdots & \vdots & \ddots & \vdots & \\
b^{n}_{1} & b^{n}_{2} & \cdots & b^{n}_{n} \\
\end{bmatrix}

\\

= 

\begin{bmatrix}
W \cdot x_1 + b_1 & \cdots & W \cdot x_m + b_m \\
\end{bmatrix} \\
$$

维度检查：$(n \times n) (n \times m) \rightarrow (n \times m)$



