[环回免除列表 loopback](https://v2ex.com/t/744981)



# vscdoe + MSVC

[VS Code for Microsoft C++](https://code.visualstudio.com/docs/cpp/config-msvc)

```
解决 vscode 调试窗口 utf8 显示乱码
win键 -> 设置 -> 时间和语言 -> 最右边"日期、时间和区域格式设置" 
  ->其他日期、时间和区域设置 ->区域 更改日期、时间或数字格式
  -> 管理 ->更改系统区域设置 ->Beta版:使用Unicode UTF-8提供全球语言支持


打开 Developer Command Prompt for VS 2019 命令行
在这个命令行运行 code ，会打开 vscode
打开目录 -> 打开文件t.cpp -> ctrl + shift + P -> 输入C++ 
  -> 选 C/C++:Debug C/C++File
  	# 会自动生成 task.json

{
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: cl.exe build active file",
            "command": "cl.exe",
            "args": [
                "/Zi",
                "/EHsc",
                "/nologo",
                "/Fe${fileDirname}\\${fileBasenameNoExtension}.exe",
                "${file}"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$msCompile"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ],
    "version": "2.0.0"
}




```





[vscode使用visual studio编译工具MSVC构建C++工程](https://blog.csdn.net/qq_37429313/article/details/120588483)

```
ctrl + shift + x -> 输入 easy c
	# 安装 Easy C++ projects 插件

ctrl + shit + p -> 输入 c json
	# 会生成 c_cpp_properties.json

ctrl + shit + p -> 输入 easy -> 选新建工程
	# 选 x64 visual studio 2019
	# 会自动生成 .vscode 下的各种配置

```



```
# 自动生成的 build.bat 修改成这样
@echo off
if exist "C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\VC\Auxiliary\Build\vcvarsall.bat" (
    call "C:\Program Files (x86)\Microsoft Visual Studio\2019\BuildTools\VC\Auxiliary\Build\vcvarsall.bat" x64
) else (
    if exist "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat" (
        call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat" x64
    ) else (
        call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Auxiliary\Build\vcvarsall.bat" x64
    )
)
set compilerflags=/Od /Zi /EHsc /std:c++latest /I include /I C:\src\vcpkg\packages\fplus_x64-windows\include
set linkerflags=/OUT:bin\main.exe
cl.exe %compilerflags% src\*.cpp /link %linkerflags%
del bin\*.ilk *.obj *.pdb
```



```
# 自动生成的(不是) main.cpp 修改成这样
#include <fplus/fplus.hpp>
#include <iostream>
using namespace std;

bool is_odd_int(int x) { return x % 2 != 0; }

int main(){
    typedef vector<int> Ints;
    Ints values = { 24, 11, 65, 44, 80, 18, 73, 90, 69, 18 };
    auto odds = fplus::keep_if(is_odd_int, values);
    std::cout << "done." << std::endl;
}
```



```
# 对比 MSYS32 MINGW64 或许可以改进一下
{
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: g++.exe build active file",
            "command": "C:\\msys64\\ucrt64\\bin\\g++.exe",
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${fileDirname}\\${fileBasenameNoExtension}.exe",
                "-IC:\\Program Files (x86)\\FunctionalPlus\\include"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ],
    "version": "2.0.0"
}
```



# vscdoe + windows ssh

https://github.com/PowerShell/Win32-OpenSSH/releases/download/v9.5.0.0p1-Beta/OpenSSH-Win64-v9.5.0.0.msi

- ```
  nmap -p 22 127.0.0.1
  	# 装完以后 windows 的 22 端口就打开了
  	
  ```

  

```
Stop-Service -Name sshd -Force
Set-Service -Name sshd -StartupType Disabled
	# 停止 ssh 服务

netstat -aon | findstr "22"
	# 查看端口

```





```
Get-WindowsCapability -Online | ? Name -like 'OpenSSH*'
	# powershell 管理员执行

Add-WindowsCapability -Online -Name OpenSSH.Client~~~~0.0.1.0
	# install

ssh i@127.0.0.1
	# powershell 成功连上


C:\Users\i\.ssh\config
Host 127.0.0.1
  HostName 127.0.0.1
  Port 22
  User i
  	# vscode 成功连上 windows
  	# 甚至能打开 C 盘根目录


```



## wsl after ssh

```
[2024-07-21 03:18:52.192] Extension version: 0.88.2
[2024-07-21 03:18:52.192] L10N bundle: undefined
[2024-07-21 03:18:52.286] authorityHierarchy: ssh-remote+192.168.1.5 > wsl+Ubuntu-22.04
[2024-07-21 03:18:52.286] WSL extension is activating remotely for ssh-remote+192.168.1.5
[2024-07-21 03:19:04.504] Workspace platform is Windows
[2024-07-21 03:19:04.523] Run: C:\Windows\System32\wsl.exe --status
[2024-07-21 03:19:04.524] Resolving wsl+Ubuntu-22.04, resolveAttempt: 1
[2024-07-21 03:19:04.603] WSL feature installed: true (wsl --status)
[2024-07-21 03:19:04.603] WSL feature installed: true
[2024-07-21 03:19:04.618] Run: C:\Windows\System32\wsl.exe --list --verbose
[2024-07-21 03:19:04.692] 2 distros found
[2024-07-21 03:19:04.693] Starting VS Code Server inside WSL (wsl2)
[2024-07-21 03:19:04.693] Windows build: 22631. Multi distro support: available. WSL path support: enabled
[2024-07-21 03:19:04.693] Probing if server is already installed: if [ -d "$HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729" ]; then printf 'install-found '; fi; if [ -f /etc/alpine-release ]; then printf alpine-; fi; uname -m
[2024-07-21 03:19:04.693] Run: C:\Windows\System32\wsl.exe -d Ubuntu-22.04 -e sh -c if [ -d "$HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729" ]; then printf 'install-found '; fi; if [ -f /etc/alpine-release ]; then printf alpine-; fi; uname -m
[2024-07-21 03:19:04.751] Probing result: x86_64
[2024-07-21 03:19:04.751] VS Code CLI not found in Ubuntu-22.04, installing...
[2024-07-21 03:19:04.751] Remove old installs from $HOME/.vscode-server/bin-cli
[2024-07-21 03:19:04.751] Run: C:\Windows\System32\wsl.exe -d Ubuntu-22.04 -e sh -c if [ -d "$HOME/.vscode-server/bin-cli" ]; then rm -rf "$HOME/.vscode-server/bin-cli"/????????????????????????????????????????; rm -rf "$HOME/.vscode-server/bin-cli"/????????????????????????????????????????-*; fi
[2024-07-21 03:19:04.809] Create directory $HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729-1721531944809
[2024-07-21 03:19:04.809] Run: C:\Windows\System32\wsl.exe -d Ubuntu-22.04 -e sh -c mkdir -p "$HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729-1721531944809"
[2024-07-21 03:19:04.875] Aquire cli: C:\Windows\System32\wsl.exe -d Ubuntu-22.04 -e sh -c tee "$HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729-1721531944809/code-cli" >/dev/null, commit: f1e16e1e6214d7c44d078b1f0607b2388f29d729, platform: linux-x64, quality: stable
[2024-07-21 03:19:10.952] Move directory $HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729-1721531944809 to $HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729
[2024-07-21 03:19:10.952] Run: C:\Windows\System32\wsl.exe -d Ubuntu-22.04 -e sh -c mv "$HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729-1721531944809" "$HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729" && chmod +x "$HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729/code-cli"
[2024-07-21 03:19:11.012] Run cli: C:\Windows\System32\wsl.exe -d Ubuntu-22.04 $HOME/.vscode-server/bin-cli/f1e16e1e6214d7c44d078b1f0607b2388f29d729/code-cli
[2024-07-21 03:19:11.018] VS Code CLI is running in WSL...
[2024-07-21 03:19:11.018] Installing server in Ubuntu-22.04
[2024-07-21 03:19:11.156] [nested server]: [2024-07-21 11:19:10] info Checking /root/.vscode/cli/servers/Stable-f1e16e1e6214d7c44d078b1f0607b2388f29d729/log.txt and /root/.vscode/cli/servers/Stable-f1e16e1e6214d7c44d078b1f0607b2388f29d729/pid.txt for a running server...
[2024-07-21 03:19:11.260] [nested server]: [2024-07-21 11:19:10] debug Installing and setting up Visual Studio Code Server...
[2024-07-21 03:19:11.260] [nested server]: [2024-07-21 11:19:10] debug [reqwest::connect] starting new connection: https://update.code.visualstudio.com/
[2024-07-21 03:19:11.260] [nested server]: [2024-07-21 11:19:10] trace making delegated request to https://update.code.visualstudio.com/commit:f1e16e1e6214d7c44d078b1f0607b2388f29d729/server-linux-x64/stable
```





# win10 重置网络

```
netsh winsock reset

172.16.6.1
172.16.6.238

```





### socks5 转 http

```
# https://maplege.github.io/2017/09/04/socksTOhttp/
	# socks转为http代理
	apt update && apt-get install privoxy
	vi /etc/privoxy/config
	forward-socks5   /               172.16.6.253:1080 .
	listen-address 0.0.0.0:1080
    service privoxy restart
    http_proxy=http://127.0.0.1:1080 curl google.com
    	# 成功访问 google
```





# 调虚拟内存

我的电脑 ->属性 -> 高级系统设置 ->高级 -> 性能 ->设置 -> 高级 ->更改



```
dd if=/dev/zero of=/mnt/swapfile bs=1M count=20480
	# 20G 空文件

mkswap /mnt/swapfile
	# 格式化交换文件

swapon /mnt/swapfile
	# 挂载交换文件

vi /etc/fstab
/mnt/swapfile swap swap defaults 0 0
	# 加在后面，开机自动加载
	
free -h
	# 查看内存大小
```



# 启动管理

```

Windows +R -> msconfig。也可以打开开始菜单程序列表中的 “Windows 管理工具”，“系统配置”。Windows 10 系统则打开“任务管理器”后就能管理启动项。
```



# 端口转发

```

netsh interface portproxy show all

地址            端口        地址            端口
--------------- ----------  --------------- ----------
0.0.0.0         2222        127.0.0.1       22

	# 查看已有端口转发，本机 2222 -> wsl 的 22


netsh interface portproxy add v4tov4 listenport=2222 listenaddress=0.0.0.0 connectport=22 connectaddress=127.0.0.1
	# 新增端口转发


```







# 查看端口占用

```

Get-Process -Id (Get-NetTCPConnection -LocalPort 2222).OwningProcess

```





# 关闭端口进程

```
Get-NetTCPConnection -LocalPort 8080 | ForEach-Object { Stop-Process -Id $_.OwningProcess -Force }
```



# 隐藏窗口标题

```

see E:\huggingface\powershell\hidetitle.ahk

AutoHotKey

WinSet, Style, -0xC00000, ahk_exe mstsc.exe ; Remove the active window's title bar (WS_CAPTION).

	# 实测可以，windows 运程桌面窗口标题和最大最小化按钮都消失了	

```





# WSL



```
\\wsl$   win10 在 地址栏输入这个，直接定位到 wsl ubuntu 根目录

see nodejs summary.md -> InternLM

ssh -CNg -L 6006:127.0.0.1:6006 root@connect.bjb1.seetacloud.com -p 53862
http://localhost:6006
	# 成功访问 gradio

```



## 乱码

```
# wsl2 ubuntu22.04 执行
mkdir -p /usr/share/fonts/windows11 && 
cp -rf /mnt/c/Windows/Fonts/* /usr/share/fonts/windows11 && 
ls /usr/share/fonts/windows11/
	# 实测解决问题
	
设置 Ubuntu 中文语言环境
```



## 随系统启动

```
C:\Windows\system32\wsl.exe -d Ubuntu-22.04
	# 启动

打开任务计划程序。
点击右边的创建任务。
任务的名称和描述可以随便写，安全选项需要选择“不管用户是否登录都要运行”。
点击上方的“触发器”选项卡，点新建按钮，然后会卡几秒（微软的老 BUG ）。开始任务中选择“启动时”，然后点击确定。
“操作”选项卡中，点新建按钮，然后“程序或脚本”下的文本框里输入"C:\Program Files\WSL\wsl.exe"，引号也要带上（非常重要，除了这个目录下的wsl.exe，其他位置的都不行）。添加参数可以根据需要填写，比如-d Debian指定发行版。
“条件”选项卡中，所有选项全部取消勾选。
”设置“选项卡中，除了“允许按需执行任务”，其他全部取消勾选。
点击确定关闭窗口。可以先右键运行试试效果。这种方法运行的 WSL 即使当前用户注销也是会继续运行的。


```



## 阻止休眠

```
WIN+R 运行 shell:startup 打开启动目录
在此目录中创建文件 wsl-startup.vbs
在 wsl-startup.vbs 中填充如下内容，Arch需替换为你使用的发行版名称。
set ws=wscript.CreateObject("wscript.shell")
ws.run "wsl -d Arch", 0
这样当你系统启动，登录系统后，Windows会开启 WSL 实例，它会永久等待输入，不会关闭。所以当你下次再使用WSL命令时，就不会遇到需要重新唤醒 WSL 的耗时。
```





## Install wsl2

```
关键：
windows server 2022 先安装所有更新
再： wsl --update
	# 后面装 Ubuntu-20.04 就正常了

dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart

dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart

去 BIOS 开启虚拟化

wsl.exe --install --no-distribution
	# 装 android模拟器搞坏以后运行这个

wsl --list
	# 已安装

1. 控制面版卸载 ubuntu wsl
2. wsl --unregister Ubuntu-20.04
C:\Users\i\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs
	# 删文件

wsl --unregister Ubuntu-20.04
	# 这新重装后它才不错

wsl --list --online
	-> Debian
	-> Ubuntu-20.04    Ubuntu 20.04 LTS

wsl --install -d Ubuntu-20.04

    $env:http_proxy="http://127.0.0.1:7890"
    $env:https_proxy="http://127.0.0.1:7890"

    $env:all_proxy="socks5://127.0.0.1:7890"
    wsl --install -d Ubuntu-24.04
		# 代理安装
		# 实测不起作用，需要设置 windows 全局代理
		# 设置 > 网络和 Internet > 代理。
		# 在“手动代理设置”中填写 SOCKS5 地址 127.0.0.1:7890

	curl --socks5 127.0.0.1:7890 google.com
		# wsl ubuntu-20.04 clash 提供的代理
		# MinW64 这样运行
			# curl.exe --socks5 127.0.0.1:7890 google.com
				# powershell 运行一定不能少 .exe
	
	> $env:all_proxy="socks5://127.0.0.1:7890"
    > curl.exe google.com
		# 这样实测成功
	
		

wsl --set-default-version 2

wsl --update

wsl --terminate Ubuntu-22.04
	# 停止运行

wsl --shutdown
	# 关闭所有


HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LxssManager
	# On the right pane, locate Start and set the Value Data to 2.
	# 出错的话，这样就好了

cat /etc/passwd
--> root:x:0:0:root:/root:/bin/bash

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Lxss\{6f84f58e-2c93-4199-b374-eb7ccb8a61d1}
DefaultUid 改成 十进制的 0
	# 成功更改默认用户
	# 不知为什么最近失效了，看下面

ubuntu2204.exe config --default-user root
	# 更改默认用户成功
	# 试看在 .wslconfig 配置里加 ？

sudo passwd
	# 这就是改 root 密码
	
	
vi /etc/ssh/sshd_config

PermitRootLogin yes
PasswordAuthentication yes
	# 改这两个重启 ssh 成功登录

ufw disable

sudo sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config

systemctl restart ssh

ufw allow ssh


vi ~/.condarc
proxy_servers:
  http: http://172.16.6.253:8118
  https: http://172.16.6.253:8118
ssl_verify: false
	# 康达设置代理

conda clean -a
	# 代理是OK 的，出错执行这个就可以了

```



### 离线安装 wsl 镜像

```

https://cloud-images.ubuntu.com/wsl/releases/24.04/current/ubuntu-noble-wsl-amd64-wsl.rootfs.tar.gz
	# 下载

wsl --import Ubuntu24.04 E:\Ubuntu2404_wsl X:\win10_dev\ubuntu-noble-wsl-amd64-wsl.rootfs.tar.gz
	# 导入安装

wsl -l
	# 列出已安装

wsl -d Ubuntu24.04
	# 启动

wsl --terminate Ubuntu-24.04
	# 停止运行

wsl --shutdown
	# 关闭所有


```





## Install Cosmic 桌面

```

ubuntu 24.04

sudo apt update && sudo apt upgrade -y \
  && sudo apt install cargo cmake just libfontconfig-dev libfreetype-dev libexpat1-dev pkg-config -y \
  && sudo apt install libwayland-dev libxkbcommon-dev libseat-dev libinput-dev -y
  && apt install libgstreamer1.0-dev libgstreamer-plugins-base1.0-dev libdbus-1-dev -y \
  && sudo apt install libglvnd-dev libwayland-dev libseat-dev libxkbcommon-dev libinput-dev udev dbus libdbus-1-dev libsystemd-dev libpixman-1-dev libssl-dev libflatpak-dev libpulse-dev libexpat1-dev libfontconfig-dev libfreetype-dev mold libgbm-dev libclang-dev libpipewire-0.3-dev libpam0g-dev -y \
  && echo 'export PKG_CONFIG_PATH=/usr/lib/x86_64-linux-gnu/pkgconfig:$PKG_CONFIG_PATH' >> ~/.bashrc \
  && source ~/.bashrc \
  && pkg-config --cflags --libs gstreamer-1.0 \
  && apt install rustup -y && rustup update \
  && rustup default stable

git clone --recurse-submodules https://github.com/pop-os/cosmic-epoch \
  && cd cosmic-epoch \
  && just sysext
  	# 安装 cosmic 桌面
  
sudo mv cosmic-sysext /var/lib/extensions \
  && sudo systemctl enable --now systemd-sysext \
  && sudo systemctl restart gdm 
  	# 登录时选择 COSMIC 会话  
  

git clone https://github.com/pop-os/cosmic-player && cd cosmic-player \
  && cargo build
	# 成功编译


```





## windows10 限制 wsl2 内存占用

```
Windows + R -> 输入 %UserProfile% 运行进入用户文件夹 -> 新建文件 .wslconfig，加入以下内容：

C:\Users\i\.wslconfig

[wsl2]
memory=4G
swap=2G
processors=2
localhostForwarding=true

[experimental]
autoMemoryReclaim=gradual  
networkingMode=mirrored
dnsTunneling=true
firewall=true
autoProxy=true
	
	# 实际好用的配置


[wsl2]
memory=1G # 限制最大使用内存
swap=1G # 限制最大使用虚拟内存
processors=1 # 限制最大使用cpu个数
localhostForwarding=true

cmd中运行命令关闭当前的子系统
wsl --shutdown

右击左下角"win" 按钮 -> 任务管理器 -> 可以看到 Vmmem 进程的内存点用
	# 这就是 wsl2 的当前内存占用，它不是一下就占满的，会自动增长
 

```



## vscode 连 wsl2

```
Remote - SSH
	# 装插件

ssh root@localhost
	# 这样就可以了

```


## WSL2 网络终极方案　

[WSL2 网络的最终解决方案](https://zhuanlan.zhihu.com/p/593263088)



## 静态 IP

https://www.ryanshang.com/2022/10/23/WSL2%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP/



## 远程桌面

https://qiita.com/atomyah/items/887a5185ec9a8206c7c4  **必看**

https://zhuanlan.zhihu.com/p/149501381

https://zhuanlan.zhihu.com/p/657904628 WSL2的图形化支持 **必看**

https://learn.microsoft.com/zh-cn/windows/wsl/tutorials/gui-apps  先装驱动

https://askubuntu.com/questions/369012/how-to-run-a-complete-gui-as-root   各种桌面 root 登录方法



```
sudo apt update && sudo apt -y upgrade && 
sudo apt -y install xfce4 && 
sudo apt-get install xrdp 
	# 如果出现选项，选 gdm3

sudo cp /etc/xrdp/xrdp.ini /etc/xrdp/xrdp.ini.bak  && 
sudo sed -i 's/3389/3390/g' /etc/xrdp/xrdp.ini  && 
sudo sed -i 's/max_bpp=32/#max_bpp=32\nmax_bpp=128/g' /etc/xrdp/xrdp.ini && 
sudo sed -i 's/xserverbpp=24/#xserverbpp=24\nxserverbpp=128/g' /etc/xrdp/xrdp.ini && 
echo xfce4-session > ~/.xsession

vi /etc/xrdp/startwm.sh

# コメントアウト # test -x /etc/X11/Xsession && exec /etc/X11/Xsession
# コメントアウト # exec /bin/sh /etc/X11/Xsession

# xfce
startxfce4

	# 最后几行改成这样

sudo /etc/init.d/xrdp start


wsl --shutdown

 /etc/init.d/xrdp start

localhost:3390
	# win11 远程桌面连这个
	# 用户名 i 连接成功！
	# 但是 root 连，闪退！
	# 装完 chrome 正常打开，但是 terminal 打不开


apt install screenfetch && 
screenfetch
	# 显示当前桌面环境

xfce4-settings-manager
	# 命令行下面打这个，直接出图片界面！
	
apt install xfce4-terminal
	# 装这个以后，在远程桌面可以搜 xfce4 ，正常打开命令行窗口


```





```
sudo /etc/init.d/xrdp start
	# 这样启动
	
apt install xfce4 xfce4-goodies -y && 
apt install xrdp -y 

选 lightdm

dpkg-reconfigure lightdm
	# 装完以后可以用这个再选一次 lightdm

vi /etc/xrdp/xrdp.ini
port=3390
	# 端口改成 3390 防止和 windows 冲突

cd ~ && 
echo "xfce4-session" | tee .xsession 

/etc/init.d/xrdp start
	# WSL2 里面不能用 systemd, 所以需要手动启动

win10 远程桌面用这个连接：

localhost:3390
	# 成功连接！

	
```



## 关闭

```
wsl --shutdown
wsl.exe --terminate <发行版名称>
```



## 备份

```
wsl --shutdown
wsl -l -v
wsl --export Ubuntu-20.04 F:\WSL2_backup\wsl2_Ubuntu-20.04.tar
	# 备份

wsl --import Ubuntu F:\WSL2_backup\wsl2_Ubuntu-20.04.tar
	# 还原


```



## 删文件释放空间

```
在 PowerShell 中执行：

# 关闭 WSL2 中的 linux distributions
wsl --shutdown
# 运行管理计算机的驱动器的 DiskPart 命令
diskpart
在新打开的 DiskPart 命令窗口中执行：

# 选择虚拟磁盘文件
select vdisk file="C:\Users\richa\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu20.04onWindows_79rhkp1fndgsc\LocalState\ext4.vhdx"
# 压缩文件
compact vdisk
# 压缩完毕后卸载磁盘
detach vdisk
```





## Install chrome

```
apt install fonts-liberation libu2f-udev && 
wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb && 
dpkg -i google-chrome-stable_current_amd64.deb && 
apt --fix-broken install

 snap remove chromium
 	# 卸载

cd /usr/share/applications/ &&
cp google-chrome.desktop ~/Desktop/
	# 手动添加快捷方式 ？


git config --global core.autocrlf ture

wget https://dl.google.com/linux/direct/google-chrome-stable_current_x86_64.rpm && \
wget https://dl.google.com/linux/linux_signing_key.pub && \
rpm --import linux_signing_key.pub && \
dnf install -y google-chrome-stable_current_x86_64.rpm

google-chrome &
	# 注意：chrome 需要非 root 账号运行
	useradd i
	passwd i
		# 密码设置成和 root 一样

vi /usr/bin/google-chrome

最后一行加：
--user-data-dir --test-type --no-sandbox

改完后：

exec -a "$0" "$HERE/chrome" "$@" --user-data-dir --test-type --no-sandbox

	# root 成功运行 chrome
```



### 禁止用户下载有害文件

已被贵组织屏蔽

```

chrome://settings/content/insecureContent

允许显示不安全内容添加[*.]com

破案了！我把 IDM 扩展卸载后，就能用了
 

适用于在 Chrome 浏览器中登录受管理帐号的 Windows 用户。
使用组策略
在组策略管理（“计算机配置”或“用户配置”文件夹）中：
依次点击策略 接着点按 管理模板 接着点按 Google 接着点按 Google Chrome。
启用允许下载限制。
设置所需的选项：
无特殊限制
禁止所有下载恶意软件的操作
拦截危险下载内容
拦截可能造成危险的下载内容
拦截所有下载内容
为用户部署政策。
```





## 默认系统

https://zhuanlan.zhihu.com/p/643184142



```

see python 3 summary.md -> Gradio -> compile -> vscode+gradio


wslconfig  /setdefault Ubuntu-20.04
	# 默认启动 20.04
	# 20.04 用于修改编译 gradio, 生成 gradio-xxx-py3-none-any.whl

wslconfig  /setdefault Ubuntu-22.04
	# 默认启动 22.04
	# 22.04 用于 使用安装 gradio-xxx-py3-none-any.whl 并测试，以及实际开发
	
wsl --install -d Ubuntu-22.04
	# 再装一个 22.04

ubuntu2204 config --default-user root
	# 默认以 root 登录
	
```



##  wsl: 检测到 localhost 代理



```
C:\Users\i\.wslconfig

[wsl2]
memory=4G
swap=2G
processors=2





# 加入下面代理会有奇奇怪怪的问题
localhostForwarding=true

[experimental]
autoMemoryReclaim=gradual  
networkingMode=mirrored
dnsTunneling=true
firewall=true
autoProxy=true

```



## wsl 执行命令

```
# see huggingface/Sakura_Launcher_GUI/readme.txt
# pyside6 linux中文乱码
$OutputEncoding = [System.Text.Encoding]::UTF8
pyside2-uic.exe uiFile.ui | wsl ascii2uni -a U > ui_file.py 
    # 需要用 wsl 来跑
```



### 开机启动脚本

https://blog.csdn.net/popboy29/article/details/126854886

```
apt update && 
apt install cron && 
service cron start

crontab -e
@reboot  /root/run_pm2.sh

vi /root/run_pm2.sh
pm2 start pm2_proxynt_home_pc257.json


```





# choco

```
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
	# 安装 chco

choco
	# 成功执行

choco install docker-desktop --upgrade --force
	# 强制更新 docker


scoop update *


```



# windbg 调试

```

see csharp summary.md -> WPF -> RichTextBox 原生命令 ->

_ToggleBullets

FlowDocument
    ├── Block (段落级元素)
    │   ├── Paragraph
    │   ├── Section
    │   ├── List
    │   └── Table
    └── Inline (行内元素)
        ├── Run (纯文本)
        ├── Span
        ├── Hyperlink
        └── InlineUIContainer
     
wpf\src\Microsoft.DotNet.Wpf\src\PresentationFramework\System\Windows\Documents\TextEditorLists.cs

        internal static void _RegisterClassHandlers(Type controlType, bool registerEventListeners)
            CommandHelpers.RegisterCommandHandler(controlType, EditingCommands.ToggleBullets       , new ExecutedRoutedEventHandler(OnListCommand) , new CanExecuteRoutedEventHandler(OnQueryStatusNYI), KeyGesture.CreateFromResourceStrings(KeyToggleBullets, nameof(SR.KeyToggleBulletsDisplayString)));
	# 切换项目符号应该在 OnListCommand 里处理？

private static void OnListCommand(object target, ExecutedRoutedEventArgs args)
	ToggleBullets(thisSelection, parentListItem, immediateListItem, list);

dotnet tool install --global dotnet-debugger-extensions
	# 安装 dotnet 调试插件

    # choco install winget
        # C:\ProgramData\chocolatey\lib\winget
            # 装到这里了
            # 它只是一个包，根本用不了
            
    # winget install Microsoft.WinDbg
        # Administrator 账户才能找到 winget 命令
		# 也用不了
		
https://aka.ms/windbg/download
	# 下载后成功运行了 
```





# Docker+Windows 2022

https://community.microfocus.com/cyberres/fortify/f/discussions/524702/docker-install-on-windows-server-2019

- 这才是正确安装方法

https://blog.csdn.net/huanglu0314/article/details/129685114

https://www.cnblogs.com/shanyou/p/16413929.html

https://www.dell.com/support/kbdoc/en-us/000201261/docker-containers-on-windows-server-2022-101

```
2022 自带容器功能，不要安装 Docker destop

1. 添加角色和功能 ->必需从上往下一步步的点下去(默认下一步就可以) -> feature -> Contaner -> 安装它

2. Powershell 执行

[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
Install-PackageProvider -Name NuGet
Install-Module DockerMsftProvider -Force
Install-Package Docker -ProviderName DockerMsftProvider -Force
	# 出错，因为　Docker 要付费了
	
	
It is because Docker is now paid .. to install Docker community edition you can try the following in PowerShell as Administrator -


Install-WindowsFeature -Name Containers

Enable-WindowsOptionalFeature -Online -FeatureName containers -All

Install-Module -Name DockerMsftProvider -Repository PSGallery -Force

Invoke-WebRequest -UseBasicParsing "https://raw.githubusercontent.com/microsoft/Windows-Containers/Main/helpful_tools/Install-DockerCE/install-docker-ce.ps1" -o install-docker-ce.ps1

.\install-docker-ce.ps1


Invoke-WebRequest -UseBasicParsing "https://github.com/docker/compose/releases/latest/download/docker-compose-darwin-x86_64" -OutFile $env:SystemDirectory\docker-compose.exe

Restart-Computer



```





```
# windows server 2022

cd "C:\Program Files\Docker\Docker\"

& '.\Docker Desktop Installer.exe'
	# 启动失败
	empty package
   at Docker.Installer.InstallWorkflow.<DoProcessAsync>d__23.MoveNext()

"HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control"
ServicesPipeTimeout=dword:0000ea60


Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
	# 安装 chco

choco
	# 成功执行

choco install docker-desktop --upgrade --force
	# 强制更新 docker
	# 重启系统，运行前面的命令虽然还弹错，但是可以启动不闪退了
	
```



# .nuget 占用空间过大

https://blog.csdn.net/songhuangong123/article/details/139597164



# 定时任务



```

# E:\huggingface\powershell\candy.ps1
candy --mode="client" --websocket="ws://xxx:1587" --password="xxx" --tun="10.0.0.2/24" --name="clien1" --stun="stun://stun.canets.org" --port=2587


schtasks /Create /SC MINUTE /MO 1 /TN "MyTask"  /RU SYSTEM  /TR "powershell.exe -ExecutionPolicy Bypass -File E:\huggingface\powershell\candy.ps1"
	# 每隔 1 分钟执行一次脚本

schtasks /Delete /TN "MyTask" /F
	# 删除任务

```







```
see nodejs summary.md -> 抱抱脸

push.ps1
# 每次都新建分支，删除原分支 main, 重命名分支（避免 .git 超大）
cd E:\huggingface\pandoraNext
git checkout --orphan  new_branch
git add -A
git commit -am "m"
git branch -D main
git branch -m main
git push -f origin main
xcopy E:\Github\echodict\pandora\*.xlsx E:\huggingface\pandoraNext /k /e /d /Y
git lfs install
git add .
git commit -m 'm'
git lfs migrate import --everything
git push
	# 成功
	
schtasks /Create /SC MINUTE /MO 10 /TN "MyTask" /TR "powershell.exe -ExecutionPolicy Bypass -File E:\huggingface\push.ps1"
	# 每隔十分钟执行一次脚本

schtasks /Delete /TN "MyTask" /F
	# 删除任务


git pull && git LFS pull
	# 本地是文件指针时，可以这样恢复成实际文件

```





# 远程桌面一直请稍后

https://zhuanlan.zhihu.com/p/568825875

```
如果你的 Windows 远程桌面在尝试连接时一直卡在“请稍候”界面，可以尝试以下解决方法：

### 方法 1：确保网络连接正常
1. 确认客户端计算机和远程服务器都已连接到网络。
2. 测试两台机器之间是否可以互相 ping 通。
   - 打开命令提示符，输入以下命令并按下回车：
```
     ping [远程服务器IP地址]
     ```
   - 如果无法 ping 通，检查网络配置（例如防火墙或VPN）。

---

### 方法 2：重启远程桌面服务
有时远程桌面服务可能出现问题，可以尝试在目标计算机上重启这项服务：
1. 登录到远程计算机（如果可以通过其他途径访问目标计算机，例如控制台或桌面的直接访问）。
2. 打开“运行”（快捷键：Win + R），输入 `services.msc` 并按回车。
3. 找到以下服务，并按顺序右键点击`重启`：
   - **Remote Desktop Services（远程桌面服务）**
   - **Remote Desktop Configuration（远程桌面配置）**
   - **Remote Desktop UserMode Port Redirector（远程桌面用户模式端口重定向器）**
4. 重启后，重试远程连接。

---

### 方法 3：检查防火墙设置
1. 确保防火墙没有阻止 RDP（远程桌面协议）的通信：
   - 打开“Windows 防火墙”，在左侧选择“允许应用或功能通过 Windows Defender 防火墙”。
   - 确保“远程桌面”已启用。
2. 检查是否已启用端口 `3389`：
   - 打开命令提示符，执行命令：
     ```
     netstat -an | find "3389"
     ```
   - 如果没有监听`3389`端口，可能是远程桌面服务未正常启用。

---

### 方法 4：检查远程桌面设置
1. 在目标计算机上：
   - 打开“运行”（Win + R），输入 `sysdm.cpl`。
   - 切换到“远程”选项卡。
   - 确认“允许远程连接到此计算机”已被选中。
   - 检查是否只允许“使用网络级别身份验证的远程桌面”（NLA），如果是，确保客户端也支持 NLA。
2. 检查用户是否拥有远程登录权限：
   - 返回“远程”选项卡，点击“选择用户”。
   - 确保登录远程桌面的用户被添加到列表中。

---

### 方法 5：调整注册表项
1. 按 `Win + R` 打开运行框，输入 `regedit` 然后点击回车。
2. 进入以下路径，检查相关配置项：
   ```
   HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server
   ```
3. 确保以下键值设置正确：
   - `fDenyTSConnections` 的值为 `0`（表示允许远程桌面连接）。
   - `LogonTimeout` 设置为一个足够大的值（单位是秒，默认为60秒）。

---

### 方法 6：远程桌面连接客户端设置
1. 关闭“打开远程桌面”时的本地资源重定向功能（如硬盘、打印机、剪贴板等）：
   - 在远程桌面连接工具中，点击“显示选项” → 切换到“本地资源”选项卡。
   - 取消剪贴板共享、打印机重定向等。
2. 在“体验”选项卡中，将连接速度调低，取消特效功能。

---

### 方法 7：系统更新和重启
1. 确保目标计算机和客户端的 Windows 系统是最新版本。
2. 如果以上方法无法解决问题，可以先尝试重启目标计算机。

---

### 其他情况
如果依然卡在“请稍候”界面，可能存在以下问题：
- 用户会话未正确注销。
- 系统资源不足（例如内存或 CPU 已达到瓶颈）。
- 系统出现运行错误或文件损坏，可以尝试使用 `sfc /scannow` 修复系统文件。

如果问题仍未解决，请详细描述网络环境（如是否通过 VPN 或公网IP连接）和具体错误提示，以便进一步排查。
```







# IPV6 远程桌面

https://zhuanlan.zhihu.com/p/627542501



# 内网穿透

### frp windows远程桌面

[使用frp实现windows远程桌面连接](https://blog.ligengxin.me/posts/frp-windows-remote/) [s](https://github.com/fatedier/frp/releases/download/v0.51.3/frp_0.51.3_linux_amd64.tar.gz) [c](https://github.com/fatedier/frp/releases/download/v0.51.3/frp_0.51.3_windows_amd64.zip)

[Frp-notes](https://github.com/onekb/Frp-notes)



```
# 服务端配置
frps.ini
[common]
bind_port = 7000 # 服务器端口 客户端必须配置一样的端口
vhost_http_port = 8880
	# 8880 是客户端 api 接口

# 客户端配置
frpc.ini 
[common]
server_addr = 服务器ip
server_port = 7000
[web]
type = http
local_port = 8880
custom_domains = 服务器ip
	# 没有域名这里就填服务器ip

实测 http://xxx.77:8880/searchExcel 能正常访问到内网的服务
	


[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 3389  # 远程桌面端口
remote_port = 7004 #这个是远程桌面连接主机的时候输入的ip后加上的端口

# 或者这样
[RDP]
type = tcp
local_ip = 127.0.0.1
local_port = 3389
remote_port = 7004

# 或着开放 http 端口
[web]
type = http
local_port = 8880
custom_domains = 127.0.0.1
	# 没有域名就先这样



# 启动服务端
./frps -c ./frps.ini

# 启动客户端
./frpc -c frpc.ini


# 客户端开机自启 frp 
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp 目录下写一个bat文件

cmd /k "cd /d D:\Downloads\frp_0.33.0_windows_amd64 && frpc -c frpc.ini"  


# 静默后台运行
+@echo off
+if "%1" == "h" goto begin
+mshta vbscript:createobject("wscript.shell").run("%~nx0 h",0)(window.close)&&exit
+:begin
cmd /k "cd /d D:\Downloads\frp_0.33.0_windows_amd64 && frpc -c frpc.ini"


Windows 10/11 系统是可以开启 openssh server 的。



```







## 





### frp linux ssh

[safe](https://juejin.cn/post/7130640908298485768) [2](https://scarletf.github.io/2021/02/01/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-FRP%E4%BB%A3%E7%90%86%E9%93%BE/)

```
wget https://github.com/fatedier/frp/releases/download/v0.52.3/frp_0.52.3_linux_amd64.tar.gz && \
tar xvf frp_0.52.3_linux_amd64.tar.gz && \
cd frp_0.52.3_linux_amd64

# 服务端配置
vi frps.ini
[common]
bind_port = 7000 # 服务器端口 客户端必须配置一样的端口

./frps -c frps.ini


# 客户端配置
vi frpc.ini 
[common]
server_addr = 服务器ip
server_port = 7000
[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 22
remote_port = 222 #这个是远程 ssh 连接主机的时候输入的ip后加上的端口

./frpc -c frpc.ini

ssh root@服务器ip:222
	# 这样连内网机器


# 防断，服客两端都要设置
修改 /etc/ssh/sshd_config ，ClientAliveInterval 30 ，ClientAliveCountMax 3.
重启 sshd 服务，systemctl restart sshd
退出重新登录 ssh


我也一直用 frp 来连公司电脑，我真心劝你用 stcp 方式吧，不要嫌麻烦，安全比较重要，配置参考：
​```
[common]
server_addr = xxx.com
server_port = 8888
token = xxxxxxxx

## 被访问端
[secret_rdp]
type = stcp
# 只有 sk 一致的用户才能访问到此服务
sk = xxxxxxx
local_ip = 127.0.0.1
local_port = 3389

## 访问端
[secret_rdp_visitor]
type = stcp
# stcp 的访问者
role = visitor
# 要访问的 stcp 代理的名字
server_name = secret_rdp
sk = xxxxxxx
# 绑定本地端口用于访问 SSH 服务
bind_addr = 127.0.0.1
bind_port = 13389
​```


```







# ISO下载

不要从官网下iso，评估版隔段时间自动关机



## win11

[下载](https://www.microsoft.com/en-us/software-download/windows11)



```
Get-FileHash C:\Users\Administrator\Downloads\Win11_23H2_Chinese_Simplified_x64v2.iso

Chinese Simplified 64-bit	953F9ECD3307A92FB5DAF12E3FE05603FE63181F6ABC0B08B42E632E09510E39


```



## 启动U盘

[ventoy](https://www.ventoy.net/cn/index.html)

[Rufus](https://github.com/pbatard/rufus/releases)





```
# 超级管理员

net user administrator /active:yes

```



```
普变超：
登陆其他管理员账号后，鼠标右击开始菜单-----运行，输入：
netplwiz
回车，双击需要更改的用户，切换到“组成员”，选择“标准用户”。
内置的administrator账号，请勿更改。
```



# 在此处打开命令窗口

```
Ctrl+Shift，然后右击鼠标 -> 在此处打开命令窗口
```





# 禁上运行脚本

```

npm install cnpm@7.1.0 -g --registry=https://registry.npm.taobao.org
	# 配套 node14 ok
	# npm config set strict-ssl false
		# 证书错误试试？
	# Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
		# 禁止运行脚本试试这个


npm install -g cnpm --registry=https://registry.npm.taobao.org
	# 安装是最新版 会有兼容问题
```





# 开启大小写敏感

```
fsutil file setCaseSensitiveInfo 路径 enable
	# 只针对这个路径开启

git config --global core.ignorecase false


```





# 激活

```
irm https://massgrave.dev/get | iex
  # win11 成功

slmgr /skms kms.03k.org
slmgr /ato
  # 好像失效了

```



# 卸载

[uninstall](https://kerrynotes.com/battle-net-stuck-in-updating/)

```
（1）首先把Agent.exe这个进程关掉；

（2）然后去注册表上删除计算机\HKEY_CURRENT_USER\SOFTWARE\Blizzard Entertainment\Launcher即可（把计算机上搜索出来的Blizzard文件夹删除也行）。

进入 C:\ProgramData\Battle.net\Agent 目录，把修改时间最新的那个文件夹删除Agent.8022，在启动战网，瞬间启动成功了
```



# 存档位置

```
C:\Users\(UserName)\AppData\Roaming\あざらしそふと\アマカノ2\savegen.dat

```



# 关闭防火墙

```
Set-NetFirewallProfile -Profile Domain -Enabled False
Set-NetFirewallProfile -Profile Private -Enabled False
Set-NetFirewallProfile -Profile Public -Enabled False
```







# 关闭病毒防护

https://github.com/ionuttbara/windows-defender-remover  开源工具

```
Remove-WindowsFeature Windows-Defender

```







# 禁止自动更新

```
更新暂停 3000 天
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" /v FlightSettingsMaxPauseDays /t reg_dword /d 3000 /f
```



```
修改系统时间到 2050 年，然后在更新界面，点击推迟 2 周更新，完事，下次更新就变成 2050 年了，
```



# 开启自动更新

```
按Windows+R输入services.msc打开之后找到Windows Update是否开启了呢？

按Windows+R输入gpedit.msc打开组策略，在左侧选用户配置—管理模板—Windows组件—Windows Update—在右侧选“删除使用所有Windows Update功能的访问”双击它，在打开的对话框中选择“已启用”然后按应用确定，重启电脑即可。
```



https://www.zhihu.com/tardis/sogou/art/534272780



# 禁止火绒自启

[禁止火绒自启](https://www.bilibili.com/read/cv23414303)

只在需要的时侯手动打开，用它的小工具。平时用卡巴

1. 火绒剑关闭火绒自启

2. 进安全模式，按win键 -> 输入ser 找到"服务" -> 找到火绒把所有服务改成 "手动" 



或者：开始-电源按钮，按住Shift同时点击“重启”，然后Win10会自动进入高级启动菜单，再点击疑难解答-高级选项-启动设置-重启。



# server 2016 关闭自动防护

```
gpedit.msc -> 计算机配置 -> 管理模板 -> Windows组件 -> Windows Defender -> 关闭Windows Defender 双击打开 

有两个选项 关闭防护、关闭实时防护 都设为 enable

```







# 找回休眠功能



```
# 管理员运行 powershell
powercfg -h on

电源和睡眠 ->其他电源设置 -> 更改当前不可用设置 -> 选择电源按钮的功能

```



# 远程唤醒

https://www.jb51.net/os/win11/911788.html

https://zhuanlan.zhihu.com/p/52607752

```
小米智能插座+BIOS设置Restore after AC Power Loss。然后在米家APP里打开就开机了，还能看用了多少度电

```





# 磁盘管理工具

```
diskmgmt.msc
```



## linux 挂载磁盘权限错误



```


# 打开回收站

```
start shell:RecycleBinFolder
	# ps 运行
```





# 磁盘在 linux 挂载下有权限错误, windows 调整分区大小出错

chkdsk /f E:
	# windows 下执行
```





# ext4 驱动 for windows

[Ext4Fsd](https://github.com/bobranten/Ext4Fsd)

[linuxfs-windows 收费](https://www.paragon-software.com/home/linuxfs-windows/)

```

Linux File Systems for Windows by Paragon Software

key: see echodict/README.md 

```





# WSL安装出错

[关闭Hyper-V](https://www.ubackup.com/enterprise-backup/disable-hyper-v.html) 并没有开



windows server 2022 安装 wsl --install 出错

- Press **‘Win + R’** keys on the keyboard together to open the Run dialog box and type the following into the run box: **REGEDIT**

- Navigate to the following registry key:

  **HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LxssManager**

- On the right pane, locate **Start** and set the **Value Data** to **2.**

- Exit **REGEDIT**, and reboot the machine to see if it works.

```
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux

wsl --install -d Ubuntu
```





# 安装 FTP 

[window server 2022 搭建FTP服务器](https://zhuanlan.zhihu.com/p/622408091)

[开启服务设置端口防火墙](https://www.vdtutorials.com/install-and-configure-ftp-server-on-windows-server-2022/)

[用户名_FTP站点](https://cloudinfrastructureservices.co.uk/how-to-setup-ftp-server-using-iis-on-windows-server-2022/)



# App Installer

[installing App Installer (winget) on Windows Server 2022](https://gist.github.com/carey/62070ee199099c4233f572a17315366d)

[winget-and-appinstaller](https://www.andreasnick.com/112-install-winget-and-appinstaller-on-windows-server-2022.html)

[Windows Server安装Microsoft Store的应用 ](https://www.cnblogs.com/cqpanda/p/16650721.html)

```

wsl --install

winget search alma
-->AlmaLinux 9  9P5RWLM70SN9  Unknown  msstore
   AlmaLinux 8 WSL  9NMD96XJJ19F  Unknown  msstore

winget install 9NMD96XJJ19F
	# 没有成功，闪退了

```



```
Windows Server 2022 无法正常使用 Microsoft Store 下载应用程序。

您可以尝试以下方案进行操作，看看是否可行：

设置>>应用>>应用和功能>>找到应用商店>>高级选项>>重置。

 

另外，您还可以尝试清理应用商店的缓存，看看是否可以恢复正常：

 

按“Win+R”键，在运行窗口中，键入 WSReset.exe并点击“ 运行 ”。

 

如果问题依旧，建议您尝试以下方案重新部署您的应用商店：

 

在打开的“管理员：Windows Powershell”窗口中输入以下命令：

 

get-appxpackage *store* | remove-Appxpackage

 

再次安装：

 

add-appxpackage -register "C:\Program Files\WindowsApps\*Store*\AppxManifest.xml" -disabledevelopmentmode


完成后重启您的 Microsoft Store ，看看是否可以正常下载安装应用程序。
```







# windows Long path

1. Open the Start menu and type “regedit.” Launch the application.
2. Navigate to `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem`
3. Right-click the value “LongPathsEnabled” and select Modify.
4. Change “Value data” from 0 to 1.
5. Click OK.



# 处理路径

- https://blog.csdn.net/zeqi1991/article/details/110531406

```

	#include <Shlwapi.h>
	#pragma comment(lib, "shlwapi.lib")
	
	//去除路径的参数
	PathRemoveArgs
	//去除路径最后的反斜杠”\”
	PathRemoveBackslash
	//在路径最后加上反斜杠”\”
	PathAddBackslash
	//去除路径前后的空格
	PathRemoveBlanks
	//在文件路径后面加上扩展名
	PathAddExtension
	//去除文件路径扩展名
	PathRemoveExtension
	//更改文件路径扩展名
	PathRenameExtension
	//去除文件名,得到目录
	PathRemoveFileSpec
	//去除路径中的首尾空格
	PathUnquoteSpaces
	//判断路径中是否有空格,有的话,就是用”“引号把整个路径包含起来
	PathQuoteSpaces
	//将一个路径追加到另一个路径后面
	PathAppend
	//合并两个路径
	PathCombine
	//去掉路径中的磁盘符或UNC部分
	PathSkipRoot
	//去掉路径中的目录部分,得到文件名
	PathStripPath
	//去掉路径的文件部分,得到根目录
	PathStripToRoot
	//根据像素值生成符合长度的路径
	PathCompactPath
	//如原始路径: C:\path1\path2\sample.txt
	//根据120像素截断后为: C:\pat…\sample.txt
	//根据25像素截断后为: …\sample.txt
	//根据字符个数来生成符合长度的路径
	PathCompactPathEx
	//将路径数据设置到对话框的子控件上
	PathSetDlgItemPath
	//去除路径中的修饰
	PathUndecorate
	//将路径中部分数据替换为系统环境变量格式
	PathUnExpandEnvStrings
	//从路径中查找路径
	PathFindOnPath
	//查找路径的扩展名
	PathFindExtension
	//获取路径的文件名
	PathFindFileName
	//查找匹配路径
	PathFindNextComponent
	//查找给定的文件名是否有给定的后缀
	PathFindSuffixArray
	//获取路径参数
	PathGetArgs
	//获取路径字符类型
	PathGetCharType
	//根据逻辑盘符返回驱动器序号
	PathGetDriveNumber
	//创建一个路径到另一个路径的相对路径。
	PathRelativePathTo
	//将一个相对路径或绝对路径转换为一个合格的路径
	PathResolve
	//规范化路径。将格式比较乱的路径整理成规范的路径格式
	PathCanonicalize
	//根据给定的磁盘序号创建根目录路径
	PathBuildRoot
	//创建目录
	CreateDirectory
	//将长路径转为8.3格式的短路径格式
	GetShortPathName
	//将短路径格式转为长路径。
	GetLongPathName
	//将长路径转为短路径格式（8.3格式）
	PathGetShortPath
	//将URL路径转为MS-DOS格式
	PathCreateFromUrl
	//把路径全部转为小写,增加可读性
	PathMakePretty
	//给路径增加系统属性
	PathMakeSystemFolder
	//去除路径中的系统属性
	PathUnmakeSystemFolder
	//从模板创建统一的路径格式
	PathMakeUniqueName
	//生成一个可执行的路径,比如有参数的,会自动将路径用”“包含
	PathProcessCommand
	//去除路径中不合法的字符
	PathCleanupSpec
	//比较并提取两个路径相同的前缀
	PathCommonPrefix
	//验证路径是否存在
	PathFileExists
	//判断路径是否匹配制定的扩展名
	PathMatchSpec
	//判断路径是否是一个有效的目录
	PathIsDirectory
	//验证路径是否一个文件名（有可能是一个路径）
	PathIsFileSpec
	//验证路径是否是可执行文件
	PathIsExe
	//注意:不仅仅是.exe,还有.bat、.com、.src等
	//路径是否为根路径
	PathIsRoot
	//判断路径是否是相对路径
	PathIsRelative
	//检测文件是否为制定类型
	PathIsContentType
	//例如:
	PathIsContentType(“hello.txt”,”text/plain”) 返回TRUE
	PathIsContentType(“hello.txt”,”image/gif”) 返回FALSE
	
	//判断路径是否是html文件类型——根据系统注册类型判断
	PathIsHTMLFile
	//判断路径是否是长路径格式
	PathIsLFNFileSpec
	//判断路径是否是一个网络路径。
	PathIsNetworkPath
	//判断路径是否含有指定前缀
	PathIsPrefix
	//判断路径是否有相同根目录
	PathIsSameRoot
	//判断路径是否是一个高度延迟的网络连接
	PathIsSlow
	//判断路径是否有系统属性（属性可以自己设定）
	PathIsSystemFolder
	//路径是否是UNC格式（网络路径）
	PathIsUNC
	//路径是否是UNC服务器
	PathIsUNCServer
	//路径是否仅仅是UNC的共享路径格式
	PathIsUNCServerShare
	//路径是否是http格式。
	PathIsURL
	//基于已存在的文件,自动创建一个唯一的文件名。比如存在”新建文件”,此函数会创建文件名”新建文件(2)”
	PathYetAnotherMakeUniqueName 

```







# 无法在分区上安装windows

```
rufus-3.17
二、无法在驱动器0分区上安装windows解决方法
1、在当前安装界面按住Shift+F10调出命令提示符窗口；
2、输入diskpart，按回车执行；
3、进入DISKPART命令模式，输入list disk回车，列出当前磁盘信息；
4、要转换磁盘0格式，则输入select disk 0回车，输入clean，删除磁盘分区；
5、输入convert mbr，回车，将磁盘转换为MBR，输入convert gpt则转为GPT；
6、最后输入exit回车退出命令提示符，返回安装界面继续安装系统。
7、然后点击新建磁盘就可以安装驱动。

记住：最重要的是，完成以上步骤之后，返回刚开始的界面重新点击安装Windows，之后，才可以。

```



# 同一个局域网中，ping不通其他电脑



```
原因：

因为windows防火墙默认设置的是不让别人ping通的，所以方法就是，修改防火墙相关设置。

步骤：控制面板 →  系统和安全 → Windows防火墙 → 高级设置 → 入站规则 → 文件和打印机共享（回显请求 - ICMPv4-In）设置为启用


现在，应该就可以成功ping通了。
```



# 更新失败

```
　操作方法：

　　1、右键点击“此电脑”，选择“管理”。

　　2、进入到计算机管理后，点击左侧下面的“服务和应用程序”，点选“服务”。

　　3、找到windows Update，点击后，选择“属性”。

　　4、进入到属性界面后，在启动类型中选：手动。点击确定后退出设置。

　　5、右击：windows Update ，选择：启动即可。

　　以上就是win10系统更新错误的详细解决方法了，大家可以按照上述的步骤来解决遇到的错误代码0x800f081f问题
```







# 手机连网上邻居

```
电脑端目前由于Win10 系统最新补丁修改了 Samba 访问服务器的安全策略，window10系统默认不开启“SMB1.0/CIFS 文件共享支持”功能，所以win10电脑连接网络邻居邻居前，要先打开SMB1.0/CIFS 文件共享。

1、进入控制面板。

2、在程序分类中找到程序和功能，在左侧栏找到启用和关闭windows功能，再依次找到图中所示的SMB 1.0 /CIFS 服务器，勾选左侧的勾，点击确定。

3、重启。

然后手机尝试连接，步骤如下：

将手机和电脑连接到同一个 Wi-Fi 网络。
在电脑上，设置想在手机上访问文件夹的共享权限。有关电脑侧的操作，请参考电脑所装操作系统的相关说明。
在手机上，打开“”“文件管理”。
在“分类”页签下，点击“网络邻居”，即可查看到家中的电脑设备。
点击要访问的电脑设备，输入电脑设备的登录帐号和密码。登录成功后，即可在手机上访问电脑已共享的文件。
如需停止访问，在网络邻居设备列表中，长按设备即可断开连接。
```





# 安装程序 2503 错误

[fix-2502-2503](https://www.boxaid.com/blog/how-to-fix-2502-2503-errors/)

```
cmd # 以管理员远行
msiexec /package 7z1900-x64.msi

c:\windows\temp
	# 把只读属性去掉
	# 安全里 Administrator 有完全控制权限

```







# 双网卡 Wi-Fi 中继（一收一发）



- https://www.sailstars.one/post/L2cMH1XUC/

  > 双网卡 Wi-Fi 中继（一收一发）



# mkdir -p



```
mkdir "src/java/resources" "src/main/resources"

src
-----java
-------resources
-----main
-------resources

mkdir "E:\videos\anime\Danganronpa\S01\[Kamigami] Danganronpa Kibou no Gakuen to Zetsubou no Koukousei The Animation [1280x720 x264 AAC MKV Sub(Chs,Jap)]"
```



# which

```
> Get-Command node  # 显示node 的路径
```



# ln -s

```
cd C:/
C:
cd "Program Files"
mklink /D nodejs nodejs_v14.18.1  # 创建软链接nodejs
	# 软链可以直接删除
mklink /D nodejs D:\usr\node-v10.14.2-win-x64

```



# cp -rf

[copy 命令](https://blog.csdn.net/JintGuo/article/details/77542490)

```
xcopy E:\usr\PandoraNext\* E:\huggingface\pandoraNext /k /e /d /Y
cd E:\huggingface\pandoraNext
git lfs install
git add .
git commit -m 'm'
git lfs migrate import --everything
git push
	# 成功
	
schtasks /Create /SC MINUTE /MO 10 /TN "MyTask" /TR "powershell.exe -ExecutionPolicy Bypass -File E:\huggingface\push.ps1"
	# 每隔十分钟执行一次脚本


cd E:\huggingface\pandoraNext
Copy-Item -Path "E:\usr\PandoraNext\*" -Destination "." -Recurse -Force
	# 没有作用
	
	
function Copy-FileSafer {

 [CmdletBinding()]

 param (

   [string]$path,

   [string]$destinationfolder

 )

 if (-not (Test-Path -Path $path)) {

   throw "File not found: $path" 

 }

 $sourcefile = Split-Path -Path $path -Leaf

 $destinationfile = Join-Path -Path $destinationfolder -ChildPath $sourcefile

 $b4hash = Get-FileHash -Path $path

 try {

    Copy-Item -Path $path -Destination $destinationfolder -ErrorAction Stop

 }

 catch {

   throw "File copy failed"

 }

 finally {

   $afhash = Get-FileHash -Path $destinationfile

   if ($afhash.Hash -ne $b4hash.Hash) {

      throw "File corrupted during copy"

   }

   else {

     Write-Information -MessageData "File copied successfully" -InformationAction Continue

   }

 }

}
```



# md5

```
Get-FileHash -Path "E:\huggingface\rwkv5-jp-explain\out\rwkv-50.pth" -Algorithm MD5
	# powershell

md5sum out2__/rwkv-50.pth 
	# ubuntu

```





# 查看端占用



```
netstat -aon | findstr "8080"
netstat -ano | findstr :6006
```





# 杀进程

```
taskkill -PID 进程号 -F
```



```
 Get-Process | Where-Object { $_.Name -like "Face*" } | Stop-Process
 	# kill 掉以 Face* 开头的进程

```





# 端口转发

```

netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=2222 connectaddress=127.0.0.1 connectport=22
	# WSL2 的 22 端口原先只有 127.0.0.1:22 它才通
	# candy 10.0.0.3:2222 现在可以这样访问
	# nmap -p 2222 10.0.0.3 
		# 实测连通


netsh interface portproxy add v4tov4  listenaddress=209.141.34.77 listenport=80 connectaddress=209.141.34.77 connectport=7999
	# 80 转 7999

netsh interface  portproxy show  v4tov4
	# show

netsh interface  portproxy delete v4tov4 listenaddress=209.141.34.77 listenport=80
	# delete

```



# 打开任务管理器

```
Start-Process -FilePath "Taskmgr.exe" -Verb RunAs
```





# 遍历进程

[遍历进程](https://github.com/dbshch/DOAXVV-script)



# 多用户远程登录

- https://www.exitthefastlane.com/2018/02/resource-sharing-in-server2016-rdsh.html?m=1



# Win10 WSL | Ubuntu 18.04 with Xfce & Xrdp



## MUST make sure that the XRDP doesn’t use port 3389 

- which is used by Microsoft RDP (in case if your Windows 10 is already configured for RDP)



```
sudo apt install xfce4
sudo apt install xrdp && \
sudo echo xfce4-session >~/.xsession && \
sudo service xrdp restart
```



### Change the port from 3389 to 3390



```
vi /etc/xrdp/xrdp.ini

service xrdp restart
```



## Use Win10 remote destop to connect



Press Win key -> 附件 -> 远程桌面

> input: 
>
> localhost:3390








```
sudo apt-get install xfce4

如果网速较慢，这会持续一段时间。

然后安装xrdp组件和vnc服务器：

sudo apt-get install xrdp vnc4server

安装好后要自行新建配置文件，使得在远程登录时默认使用xfce作为界面登录，然后重启xrdp服务：

echo "xfce4-session" >~/.xsession

sudo service xrdp restart

这个相当于在当前用户的home目录下新建一个名为.xsession的隐藏文件，并向文件中写入一行xfce4-session。也可以用touch新建文件，并用vi编辑：

touch ~/.xsession

vi ~/.xsession
```









# Docker

- https://blog.yowko.com/windows-server-2016-hyper-v/
  - 如何在 Windows Server 2016 上安裝 Hyper-V

- https://blog.yowko.com/windows-server-2016-linux-container/
  - 在 Windows Server 2016 上使用 Linux Container



# NFS



- https://blog.csdn.net/qq_34158598/article/details/81976063



# 内网测速

- https://zhuanlan.zhihu.com/p/137958252

  > iPerf3 搭建局域网内部测速环境



# wifi crack



- https://lofter.me/2018/10/22/Kali-Linux-%E9%AB%98%E6%95%88%E7%A0%B4%E8%A7%A3Wifi%E5%AF%86%E7%A0%81/



# 红米 AX6 刷机

[使用虚拟机解锁红米ax6-ssh并刷入qsdk固件](https://www.bilibili.com/video/BV1fQ4y1R7LY)

[Redmi红米AX6 解锁SSH 刷机 ](https://www.youtube.com/watch?v=Pv1VstarERg)

[红米 AX6 安装 ShellClash 体验分享](https://www.v2ex.com/t/927935)

[红米AX6 第三方不死 U-Boot 刷入教程](https://www.youtube.com/watch?v=K-MZLD62KRg)



```
AX6 ssh 192.168.31.1 密码
6e3ee24d

红米 AX6 自用精简 Openwrt：
默认系统后台：192.168.123.1
账号：root
密码：password
集成插件：ssr plus、TTYD 终端
```



## Openwrt 旁路由

[旁路由](https://blog.sinovale.com/4273.html)

[旁路由 不好用](https://zhuanlan.zhihu.com/p/112484256)

```
前提：主由路 192.168.1.1

电脑网线连 AX6, 通过 192.168.123.1 连接旁路由

网络 ->接口 ->LAN ->修改 ->基本设置

协议：静态地址
IPv4地址：192.168.1.119
IPv4子网掩码：255.255.255.0
IPv4网关：192.168.1.1
IPv4广播：空

使用自定义的DNS服务器：119.29.29.29 或 223.5.5.5
IPv6分配长度：禁用
IPv6地址：空
IPv6网关：空
IPv6路由前缀：空
IPv6后缀：空


119.29.29.29
```









## Openwrt 旁路网关

[旁路网关](https://sspai.com/post/68511)


```