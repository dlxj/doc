

# gpt api

[gtp api](https://github.com/PawanOsman/ChatGPT)

```
curl --location 'https://api.pawan.krd/v1/completions' \
--header 'Authorization: Bearer pk-***[OUR_API_KEY]***' \
--header 'Content-Type: application/json' \
--data '{
    "model": "text-davinci-003",
    "prompt": "Human: Hello\\nAI:",
    "temperature": 0.7,
    "max_tokens": 256,
    "stop": [
        "Human:",
        "AI:"
    ]
}'
```





[curl](wiz://open_document?guid=5682270a-00a8-40d6-99fc-4d0afc764a1a&kbguid=04b1d254-29e5-4fcb-afb4-9c13e2df48af)

post 数据



curl -d "username=18377576210&partnercode=7aJnyewSy9tFsmegrBH75JSvxUX5zRh7" "120.26.245.220:6879/api/user/partnerlogin"





curl -d "username=18377576210&partnercode=7aJnyewSy9tFsmegrBH75JSvxUX5zRh7" "apicommunity.ksbao.com:6879/api/user/partnerlogin"







curl -d "userName=18277286430" "115.29.210.3:8195/api/user/resetHeadImage"



curl -d "userName=18277286430" "115.29.210.3:8001/api/exam/getChapterTest1"

curl -d "userName=18277286430" "115.29.210.3:8001/api/exam/getChapterTestInfo1"

curl -d "userName=18277286430" "115.29.210.3:8001/api/exam/updateUserReply1"



curl  "115.29.210.3:8001/api/chapterMenu/getCptIDNew1"

curl  "115.29.210.3:8001/api/chapterMenu/getCptID1/1/1"



curl -d "userName=18277286430" "120.26.245.220:8001/api/exam/updateUserReply1"





curl  "115.29.210.3:2553/deleteUserchapterstatistics/18277286430"



select distinct userid, appid, cptid, AllTestID from userexamgather where appid = 332 limit 200 -- and cptid = 890 and userid = 26



reset query cache;





​    mysql.queryParam('reset query cache;',function(err,results) {

​      if (err) {

​        log.error('reset query cache; ' + err);

​        return;

​      }

​    });





save file with a spc name

   curl -o mygettext.html http://www.gnu.org/software/gettext/manual/gettext.html

save file with default name gettext.html

   curl -O http://www.gnu.org/software/gettext/manual/gettext.html



http://23.88.246.242:8888/OS_X_10.9.5_Install_USB.raw

[http://23.88.246.242:8888/](http://23.88.246.242:8888/OS_X_10.9.5_Install_USB.raw)Wolfram_Workbench_2.0.0.exe

curl -C -O http://23.88.246.242:8888/OS_X_10.9.5_Install_USB.raw

 http://115.28.221.135:8888/OS_X_10.9.5_Install_USB.raw

http://23.88.246.242:8888/so.mp4

 Make curl transfer data no faster than 10 kilobytes per second:

 

​    curl --limit-rate 10K www.far-away-site.com

 

  or

 

​    curl --limit-rate 10240 www.far-away-site.com

 

 Or prevent curl from uploading data faster than 1 megabyte per second:

 

​    curl -T upload --limit-rate 1M [ftp://uploadshereplease.com](http://ftp//uploadshereplease.com)



从上次的断点开始下载

curl -C - -O



MD5 (OS X 10.9.5 Install USB.raw) = 7a6658e0004d835e4bda316655b7c283

hash = 80C1D12CBD9DD894B435AA6A20B938D6E0CBF86F



Er for MD5 and SHA1 you can do

 

md5sum (file name)

for md5sum and

 

sha1sum (file name)



7a6658e0004d835e4bda316655b7c283 OS_X_10.9.5_Install_USB.raw

7a6658e0004d835e4bda316655b7c283 OS_X_10.9.5_Install_USB.raw



7a6658e0004d835e4bda316655b7c283 Downloads/OS_X_10.9.5_Install_USB.raw

866ce289891c73c8898a2e1d29fed154f3169ea4 OS_X_10.9.5_Install_USB.raw

866ce289891c73c8898a2e1d29fed154f3169ea4

curl -C - -O http://115.28.221.135:8888/OS_X_10.9.5_Install_USB.raw

curl -C - -O http://115.28.221.135:8888/OS_X_Base_System.dmg

Post data

  linux

​     curl -H "Content-Type: application/json" -d '{"AppEName": "CJ_CJKJ", "UserID": "8", "UserName": "13597124469", "Content": "12121"}' ![img]()[ttp://115.28.221.135:8011/api/userfeedback/Add](http://115.28.221.135:8011/api/userfeedback/Add)

windows
  curl -X POST -H "Content-Type: application/json" -d "{ \"key1\": \"value1\" }"    http://115.28.221.135:8011/api/userfeedback/Add



curl

 -X POST -H "Content-Type: text/plain" -d "new.ksbao.com" http://new.ksbao.com:8001/api/agentInfo/getAgentInfo 

curl -X POST --form AgentUrl="new.ksbao.com"  115.29.210.3:8001/api/agentInfo/getAgentInfo


magnet:?xt=urn:btih:41400459ec4eef711d2c909956bf5d49dc45c488&dn=OS+X+Mavericks+10.9.5+%2813F34%29+bootable+USB+%28DMG+File%29&tr=udp%3A%2F%2Ftracker.openbittorrent.com%3A80&tr=udp%3A%2F%2Ftracker.publicbt.com%3A80&tr=udp%3A%2F%2Ftracker.istole.it%3A6969&tr=udp%3A%2F%2Fopen.demonii.com%3A1337

41400459EC4EEF711D2C909956BF5D49DC45C488

```
OS X Mavericks 10.9.5 bootable USB (DMG File) (13F34)
Use the "Restore" option in Disk Utility to write it down on a USB-stick.

Enjoy!

How to do info..

Format Your USB Flash Drive

1. Insert the USB flash drive into your Mac’s USB port.
2. Launch Disk Utility, located at /Applications/Utilities/.
3. In the list of drives attached to your Mac, select the USB flash drive device. In my case, it’s called 14.9 GB SanDisk Cruzer Media.
4. Click the ‘Partition’ tab.
5. Select ‘1 Partition’ from the Volume Scheme dropdown menu.
6. Enter a descriptive name for your flash drive; I chose "USB Install Drive"
7. Select Mac OS X Extended (Journaled) from the Format dropdown menu.
8. Click the ‘Options’ button.
9. Select ‘GUID Partition Table’ from the list of available partition schemes.
10. Click ‘OK and click "Apply"

Now the USB flash drive is prepared you can Restore "OS X Base System.dmg" to your flash drive.

1. Click on "Restore" in the Disk Utility window.
2. Drag "OS X Base System.dmg" to "Source"
3. Drag the usb flash drive (in my case "USB Install Drive") to "Destination"
4. Click "Restore" en enter your system password.
5. Done..


For Snow Leopard users......

The source image needs to be imagescanned before it can be restored. And this is how you do it...

1. Select the image. (dmg file) (in Disk Utility)
2. Go to the top menu of the Disk Utility application: Images > Scan for Restore.
3. Now you're able to restore the dmg to your usb flash drive.
4. When done, restart the computer with ALT pressed and select the usb.		
```



来源： <http://thepiratebay.se/torrent/11054371/OS_X_Mavericks_10.9.5_(13F34)_bootable_USB_(DMG_File)>

 





# Linux下cURL使用教程之七：curl基本使用实例之发布文章到百度空间

[Adeploy](http://www.adeploy.com/author/adeploy/)[2012年8月12日](http://www.adeploy.com/2012/08/12/linux-curl-example-post-to-baidu-hi/) [0 Comments](http://www.adeploy.com/2012/08/12/linux-curl-example-post-to-baidu-hi/#respond)

前六篇之后，我们对curl的基本使用已经有了一定的了解。下面我们就在实际场景中使用我们的所学。

本篇实例目标为编写linux脚本,使用curl完成发布文章至百度空间。

下文将从百度空间登陆到发表文章，对每个过程的HTTP进行分析，并编写脚本实现。

##### 一、工欲善其事，必先利其器

抓包分析我们使用chrome自带的Developer Tools。

实际分析过程中最好把Developer Tools的Network标签左下角的“Preserve Log upon Navigation”选中，如下图圈中处：

[![Chrome Developer Tools Preserve Log upon Navigation]()](http://img.adeploy.com/developertoolspreserve.jpg)

单击变为红色即可。

此选项的作用在于当当前页面跳转到其他网页时，保存原来的日志记录。

默认不保存，比如在登陆成功一个网站后，自动跳转到其他网页，这样登陆网站过程中的记录都不保存。我们就没有办法对登陆过程进行具体分析。

##### 二、POST登陆

1、操作过程

登陆我们采用网址 https://passport.baidu.com/?login ，而不使用网址 http://hi.baidu.com/index.htm或http://hi.baidu.com/go/login 右侧的登陆框。

这是因为后者可能因为百度空间改版等原因改变，而前者是百度账号的登陆界面，变化的几率要小。而且后者界面很多图片等元素，不利于我们抓包分析。

2、登陆过程分析

登陆成功后找到/?login的POST包，如下图：

[![Developer Tools Baidu Login HTTP Analy]()](http://img.adeploy.com/DeveloperToolsBaiduLogin.jpg)

主要显示了状态信息、请求头部（Request Headers）、POST数据（Form Data）和响应头部（Response Heades）。

Query String Parameters是对GET的参数的解析，即网址中的?login。一般网址中“?”后面的都应该是参数，具体请参考[Linux下cURL使用教程之二：HTTP协议概述](http://www.adeploy.com/2012/07/28/linux-curl-http-protocol.html)中“GET命令”一节。

请求头部如下（view source模式）：

```
POST /?login HTTP/1.1 Host: passport.baidu.com Connection: keep-alive Content-Length: 215 Cache-Control: max-age=0 Origin: https://passport.baidu.com User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.168 Safari/535.19 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Referer: https://passport.baidu.com/?login Accept-Encoding: gzip,deflate,sdch Accept-Language: zh-CN,zh;q=0.8 Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3 Cookie: BAIDU_WISE_UID=...无关cookie代码，很长，略去
```

POST数据如下（view decoded模式，因为curl可以完成urlencode，我们发送明文即可）：

1. **tpl_ok:**

2. **next_target:**

3. **tpl:**

4. **skip_ok:**

5. **aid:**

6. **need_pay:**

7. **need_coin:**

8. **pay_method:**

9. u:

   .%2F

10. return_method:

    get

11. **more_param:**

12. **return_type:**

13. psp_tt:

    0

14. password:

    youcan’tsee

15. safeflg:

    0

16. isphone:

    false

17. username:

    Adeploy

18. **verifycode:**

19. mem_pass:

    on

3、登陆过程curl脚本

百度要求的不严格，因此我们不考虑来源页面（Referer）等信息，只注意隐藏User-Agent字段。同时保存cookie供后续使用。脚本如下：

```
curl -s -A  "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" -o baidu001.html -D bdcookie001.txt 
--data-urlencode username=$username 
--data-urlencode password=$password 
--data-urlencode mem_pass=on 

https://passport.baidu.com/?login
```

实验发现其他字段非必要，因此舍弃。

##### 三、POST发表文章

1、操作过程

点击“我的空间”，进入http://hi.baidu.com/home，然后点击“文字“，进入到http://hi.baidu.com/pub/show/createtext，随便写些内容，右侧加些标签，发表即可。

2、过程分析

找到对createtext的POST包。POST的url为http://hi.baidu.com/pub/submit/createtext。

请求头中没有我们关心的字段：cookie不用具体分析，Referer等字段我们不去关注。

POST数据如下：

1. title:

   Adeploy’s title

2. tags[]:

   adeploytag

3. content:

   <p>Adeploy&#39;s&nbsp;content</p><p>This&nbsp;is&nbsp;for&nbsp;curl&nbsp;learning&nbsp;test.</p>

4. private:

   0

5. imgnum:

   0

6. bdstoken:

   01ae260f7a99a896a16dfa8d9f75cf16

7. **qbid:**

8. refer:

   http://hi.baidu.com/home

9. multimedia[]:

   undefined#undefined#undefined#undefined

10. private1:

    0

11. **qing_request_source:**

title是文章标题，tags是标签，content是内容。

除此之外还有一个bdstoken字段猜不出其含义。多次测试发现，其他字段基本固定，而bdstoken字段在每次退出重新登陆后就会发生变化。

**这种字段来源有两种可能性**：

1）此字段没有实际意义

比如只是个简单的标志，服务器端并不校验此字段值。

2）服务器生成，然后在POST之前传给客户端

需要我们分析POST之前数据包的响应数据。因为可能的数据包不多（一般来讲，图片、css、js等的包可以直接排除）。

3）POST之前的某个网页动态生成

比如此网页或之前的某个网页上的js、Ajax等在客户端执行的函数生成。

这个需要审视此网页和之前的每个网页中的js等代码，甚至需要动态调试，比较麻烦。因此我们最后考虑这种情况。

3、寻找bdstoken字段

编写脚本，bdstoken传递格式类似的随机值，文章发表失败。

寻找之前的数据包，我们从后向前找，查找每个text/html等网页类型的数据包的Response内容。

Developer Tools的搜索功能搜索不到，可以右键数据包”save all as har“保存为har文件，用记事本打开即可查找。但是不能批量保存，比较繁琐。

更简单的解决方式是使用wireshark抓包，wireshark的字符串搜索可以搜索到。

我们很快找到在GET的createtext页面（http://hi.baidu.com/pub/show/createtext）里有bdstoken字段，GET及bdstoken取出语句：

```
#get bdstoken
curl -s -A  "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" -o baidu002.html 
-D bdcookie002.txt -b bdcookie001.txt 

http://hi.baidu.com/pub/show/createtext

bdstoken=""
#cat baidu002.html |grep bdstoken=|awk -F "bdstoken=" '{print $2}'|awk -F "&" '{print $1}'
echo bdstoken=$bdstoken

#check before submit
if [ -z $bdstoken ]
then
    echo "error in getting bdstoken";
    exit;
fi
```

脚本中使用了awk用于从html代码中提取bdstoken字段，HTML中相关内容为：

```
<a href="https://passport.baidu.com?logout&bdstoken=393d8ef656bf74c8f739aa3ae5262f94&u=http://hi.baidu.com/pub/show/createtext">退出</a>
```

“bdstoken=”作为前分割标志，“&”作为结束标志即可。

4、curl脚本

1）POST过程

```
title="Adeploy's title"
content="Adeploy's content!<p>This is for curl learning test."
tags="testtags"
curl -s -A  "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" -e http://hi.baidu.com/pub/show/createtext 
-o baidu003.html -D bdcookie003.txt -b bdcookie001.txt 
--data-urlencode title="$title" 
--data-urlencode tags[]=$tags 
--data-urlencode content="$content" 
--data-urlencode private=0 
--data-urlencode imgnum=0 
--data-urlencode bdstoken=$bdstoken 
--data-urlencode qbid= 
--data-urlencode refer=http://hi.baidu.com/home 
--data-urlencode multimedia[]=:undefined#undefined#undefined#undefined 
--data-urlencode private1=0 
--data-urlencode qing_request_source= 

http://hi.baidu.com/pub/submit/createtext
```

使用的cookie是第一版步产生的bdcookie001

这是因为基本上只有第一步登陆的过程产生重要的cookie信息，其他步产生的cookie是非必须的。

2）验证成功与否：

```
#result
result=cat baidu003.html |awk -F ": "" '{print $2}'|awk -F """ '{print $1}'
if [ $result -eq 0 ]
then
    echo "Success!"
else
    echo "Fail!"
fi
```

3）资源清理语句：

```
rm -f baidu001.html baidu002.html baidu003.html
rm -f bdcookie001.txt bdcookie002.txt bdcookie003.txt
```

##### 四、注意

1）POST文章时，title、content中不能含有特殊字符

title、content中不能含有双引号不能转义的特殊字符，如$,\。

单引号不转义除单引号之外的所有特殊字符。而且在title=”Adeploy’s title”和–data-urlencode title=”$title” 两处都使用单引号的会出现错误。

因此如果实际应用的话，还需要另外一个特殊字符替换函数，替换$,\和双引号。

shell脚本对大批量文字的处理比较繁琐吃力。

因此实际场景中，遇到对文字处理较多的场景，shell脚本+curl的方式只作为测试手段探究原理与逻辑，程序使用Java、PHP、Python、C等更强大的语言实现。

2）没有错误重试

可以使用如下循环进行错误重试：

```
#retry after fail
COUNTER=0
#当失败时循环5次
while [ fail ]
do
        if [ $COUNTER -gt 5 ];then
                echo error
                exit
        fi
        sleep 60
        #curl语句
        COUNTER=expr $COUNTER + 1
done
```

3）文件权限

文件中保存有账户密码，记得设置文件属性为700，避免密码泄露。

##### 五、总结

完整脚本请到下载：[baiduhipost.sh](http://down.qiannao.com/space/file/dongliang0531/share/curl//baiduhipost.sh/.page)



来源： <http://www.adeploy.com/2012/08/12/linux-curl-example-post-to-baidu-hi/>

 

#### 3. 强大的通配符支持

公开课的视频有很多，假设我们要全部下载，该怎么做？去循环？每次都去curl请求一次？就像这样:

[?](http://my.oschina.net/chihz/blog/96101#)

```
for` `video ``in` `1 2 3 4;``do``curl -o video${video}.mp4 http:``//xxx``.com``/video``${video}.mp4``done
```

其实今天才发现只需要一条命令就能够搞定:

[?](http://my.oschina.net/chihz/blog/96101#)

```
curl -o ``'video#1.mp4'` `'http://xxx.com/video[1-4].mp4'
```

这样就可以下载所有的视频，并且所有的视频都会依次以video1.mp4 video2.mp4...这样来在本地进行保存。

另外范围的通配符还支持前面置0的做法:

[?](http://my.oschina.net/chihz/blog/96101#)

```
curl -O http:``//www``.curltest.com``/test``[00-99].mp3
```

就会自动下载test00.mp3 到 test99.mp3

另外还可以指定步长:

[?](http://my.oschina.net/chihz/blog/96101#)

```
curl -O http:``//www``.curltest.com``/test``[00-99:2].mp3
```

嗯，感觉跟Python的range差不多吧。挺高端的。

除了表示范围的通配符，还可以提供词汇列表的通配:

[?](http://my.oschina.net/chihz/blog/96101#)

`curl -O http:``//www``.urltest.com/{minzufeng,tante}.mp3` 来源： <http://my.oschina.net/chihz/blog/96101> 